<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">

<head>
    <th:block sec:authorize="isAuthenticated()">
        <meta name="_csrf" th:content="${_csrf.token}"/>
        <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    </th:block>
</head>

<th:block layout:fragment="css">
    <style>
        .write-wrap {
            margin: 1rem;
        }

        .write-wrap .title {
            font-size: 1.6rem;

            /* width: calc(100% - 2rem); */
            width: 100%;
            box-sizing: border-box;

            padding: 2rem;
            margin-bottom: 1rem;
            /* margin-left: 1rem;
            margin-right: 1rem; */

            border: 1px solid #d1d3d8;
        }

        .write-wrap .content {
            font-size: 1.6rem;

            width: 100%;
            height: 20rem;
            box-sizing: border-box;

            padding: 2rem;

            border: 1px solid #d1d3d8;
        }

    </style>
</th:block>

<div layout:fragment="content">
    <div class="write-wrap">
        <div class="title">[[${dto.title}]]</div>
        <div class="content">[[${dto.content}]]</div>
    </div>

    <div class="my-4">
        <a th:href="|@{/}|" class="text-decoration-none">
            <button type="button" class="btn btn-outline-dark">목록</button>
        </a>

        <th:block sec:authorize="isAuthenticated()">
            <button type="button" class="btn btn-outline-dark" onclick="remove()">삭제</button>
        </th:block>
    </div>
</div>


<script layout:fragment="script" th:inline="javascript">
    async function remove() {
        id = [[${dto.id}]];
        var header = $("meta[name='_csrf_header']").attr("content");
        var token = $("meta[name='_csrf']").attr("content");

        await fetch(`../remove/${id}`, {
            method: "DELETE",
            headers: {
                [header]: token
              },
        });

        location.href='/';
    }

</script>
